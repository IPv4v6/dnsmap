Thanks to Philipp Winter from 7c0.org for spotting some bugs and submitting fixes.
